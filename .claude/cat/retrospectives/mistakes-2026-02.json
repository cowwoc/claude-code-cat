{
  "period": "2026-02",
  "mistakes": [
    {
      "id": "M001",
      "timestamp": "2026-02-17T00:00:00Z",
      "category": "protocol_violation",
      "description": "Agent skipped stakeholder review re-run after fix iteration",
      "root_cause": "REFLECTION module failure: Agent did not verify that fixes resolved concerns and introduced no new issues before proceeding to merge",
      "rca_method": "B",
      "rca_method_name": "taxonomy",
      "prevention_type": "skill",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/plugin/skills/work-with-issue/first-use.md",
      "pattern_keywords": [
        "review",
        "fix-iteration",
        "verification"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Always re-run stakeholder review after addressing concerns to verify fixes resolved issues and introduced no new problems"
    },
    {
      "id": "M344",
      "timestamp": "2026-02-17T00:00:00Z",
      "category": "protocol_violation",
      "description": "stakeholder-review skill uses HEAD~1..HEAD for file diff, missing commits when worktree has multiple changes",
      "root_cause": "Skill assumes single-commit workflow but CAT allows iteration. HEAD~1 refers to previous commit in worktree, not base branch",
      "rca_method": "C",
      "rca_method_name": "causal-barrier",
      "prevention_type": "code_fix",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/plugin/skills/stakeholder-review/first-use.md",
      "pattern_keywords": [
        "stakeholder-review",
        "HEAD~1..HEAD",
        "git diff",
        "file context",
        "worktree commits"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Use base_branch..HEAD for diff operations to capture all commits since worktree diverged from base branch. Read base_branch from cat-base worktree metadata file, fallback to HEAD~1 for non-worktree scenarios"
    },
    {
      "id": "M345",
      "timestamp": "2026-02-17T00:00:00Z",
      "category": "protocol_violation",
      "description": "Agent reported failure when Skill tool re-invocation returned re-invocation instructions instead of echoing previously generated skill output",
      "root_cause": "reference.md re-invocation instructions only say to use the Skill tool again, but give no guidance for when the Skill tool itself returns re-invocation instructions (the loop case). No fallback path was documented for this scenario.",
      "rca_method": "A",
      "rca_method_name": "5-whys",
      "prevention_type": "skill",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/plugin/skills/reference.md",
      "pattern_keywords": [
        "re-invocation",
        "skill-loop",
        "status",
        "echo-output",
        "protocol_violation",
        "preprocessor"
      ],
      "prevention_implemented": false,
      "prevention_verified": false,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "When Skill tool re-invocation returns the same re-invocation instructions again, search conversation history for the most recent skill output and echo it verbatim. Do not report failure."
    },
    {
      "id": "M346",
      "timestamp": "2026-02-18T15:42:02Z",
      "category": "misleading_documentation",
      "description": "Orchestrator used \"squash commit\" as squash message instead of the primary implementation commit message",
      "root_cause": "work-with-issue-first-use/SKILL.md mismatch correction example displayed \"squash commit\" as a sample bad message, normalizing that string as a recognizable commit message pattern. Combined with v2.1 git history containing a prior squash commit with the same message, the LLM was primed to produce \"squash commit\" when executing Step 6 squash. The git-squash-quick.sh validation script would have rejected this message, but the orchestrator bypassed it with direct git commands.",
      "rca_method": "B",
      "rca_method_name": "taxonomy",
      "prevention_type": "skill",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/plugin/skills/work-with-issue-first-use/SKILL.md",
      "pattern_keywords": [
        "squash-commit",
        "commit-message",
        "priming",
        "mismatch-example",
        "work-with-issue"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "medium",
        "catches_variations": true
      },
      "correct_behavior": "Use the primary implementation commit message from the execution result as the squash message. The squash script git-squash-quick.sh validates the message format and would reject non-descriptive messages like \"squash commit\"."
    },
    {
      "id": "M347",
      "timestamp": "2026-02-18T19:25:45Z",
      "category": "protocol_violation",
      "description": "Main agent spawned work-merge subagent while shell CWD was inside the worktree, causing shell session corruption after worktree removal",
      "root_cause": "Documentation in work-with-issue-first-use/SKILL.md (line 719) instructs agent to cd /workspace before spawning the merge subagent, but agent failed to comply. The instruction existed but the protocol was violated. Subagent operates in its own shell context so checking subagent CWD does not help - the MAIN agent must exit the worktree before delegation.",
      "rca_method": "C",
      "rca_method_name": "causal-barrier",
      "prevention_type": "hook",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/client/src/main/java/io/github/cowwoc/cat/hooks/task/EnforceWorktreeSafetyBeforeMerge.java",
      "pattern_keywords": [
        "worktree-removal",
        "cwd-corruption",
        "shell-session",
        "work-merge",
        "cd-before-spawn"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Before spawning the work-merge subagent, run 'cd /workspace' so the main agent's shell CWD is not inside the worktree when the subagent removes it."
    },
    {
      "id": "M348",
      "timestamp": "2026-02-18T19:30:42Z",
      "category": "protocol_violation",
      "description": "merge-and-cleanup.sh did not delete backup-before-squash-* branches left by git-squash-quick.sh after successful merge",
      "root_cause": "work-with-issue Step 6 runs git-squash-quick.sh before each approval gate presentation. When the workflow loops (user rejects, more work done, loop back to Step 6), each squash iteration creates a new uniquely-timestamped backup branch. git-squash-quick.sh only deletes the backup it JUST created on success â€” it cannot know about backups from previous loop iterations. merge-and-cleanup.sh, which runs after the final successful merge, had no logic to delete these orphaned backup branches.",
      "rca_method": "A",
      "rca_method_name": "5-whys",
      "prevention_type": "code_fix",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/plugin/scripts/merge-and-cleanup.sh",
      "pattern_keywords": [
        "backup-branch",
        "squash-cleanup",
        "merge-and-cleanup",
        "git-squash-quick",
        "orphaned-branches",
        "approval-gate-retry"
      ],
      "prevention_implemented": false,
      "prevention_verified": false,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "merge-and-cleanup.sh should delete all backup-before-squash-* branches after a successful merge. Add a step between branch deletion and lock release that runs: git branch | grep 'backup-before-squash-' | while read b; do git branch -D $b; done"
    },
    {
      "id": "M349",
      "timestamp": "2026-02-18T22:17:37Z",
      "category": "incorrect_implementation",
      "description": "Status display inner boxes rendered with individually-sized widths, causing inner right borders to appear at different horizontal positions (jagged right edges)",
      "root_cause": "generateStatusDisplay() calls buildInnerBox() for each major version without coordinating widths. Each call independently calculates boxWidth from its own content, so boxes with more content are wider. Different-width inner boxes placed in the outer box create visually jagged right borders even though the OUTER box right border aligns correctly.",
      "rca_method": "B",
      "rca_method_name": "taxonomy",
      "prevention_type": "code_fix",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/client/src/main/java/io/github/cowwoc/cat/hooks/skills/GetStatusOutput.java",
      "pattern_keywords": [
        "box-alignment",
        "inner-box-width",
        "status-display",
        "buildInnerBox",
        "uniform-width"
      ],
      "prevention_implemented": false,
      "prevention_verified": false,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Pre-calculate the maximum inner box content width across all major versions, then pass that as forcedWidth to each buildInnerBox() call so all inner boxes render at uniform width."
    },
    {
      "id": "M350",
      "timestamp": "2026-02-18T22:45:00Z",
      "category": "protocol_violation",
      "description": "Implemented empty-string fallback for invalid sessionId format instead of throwing exception",
      "root_cause": "The fail-fast principle in common.md only showed Bash examples and did not list identifiers used to construct file paths as non-acceptable fallbacks; the HookInput.getString() pattern of returning empty string primed the agent to use the same pattern for getSessionId()",
      "rca_method": "C",
      "rca_method_name": "causal-barrier",
      "prevention_type": "documentation",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/.claude/rules/common.md",
      "pattern_keywords": [
        "fail-fast",
        "fallback",
        "empty-string",
        "session-id",
        "file-path",
        "java"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Throw IllegalArgumentException when sessionId format is invalid, since sessionId is used to construct file paths"
    }
  ]
}
