{
  "period": "2026-02",
  "mistakes": [
    {
      "id": "M001",
      "timestamp": "2026-02-17T00:00:00Z",
      "category": "protocol_violation",
      "description": "Agent skipped stakeholder review re-run after fix iteration",
      "root_cause": "REFLECTION module failure: Agent did not verify that fixes resolved concerns and introduced no new issues before proceeding to merge",
      "rca_method": "B",
      "rca_method_name": "taxonomy",
      "prevention_type": "skill",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/plugin/skills/work-with-issue/first-use.md",
      "pattern_keywords": [
        "review",
        "fix-iteration",
        "verification"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Always re-run stakeholder review after addressing concerns to verify fixes resolved issues and introduced no new problems"
    },
    {
      "id": "M344",
      "timestamp": "2026-02-17T00:00:00Z",
      "category": "protocol_violation",
      "description": "stakeholder-review skill uses HEAD~1..HEAD for file diff, missing commits when worktree has multiple changes",
      "root_cause": "Skill assumes single-commit workflow but CAT allows iteration. HEAD~1 refers to previous commit in worktree, not base branch",
      "rca_method": "C",
      "rca_method_name": "causal-barrier",
      "prevention_type": "code_fix",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/plugin/skills/stakeholder-review/first-use.md",
      "pattern_keywords": [
        "stakeholder-review",
        "HEAD~1..HEAD",
        "git diff",
        "file context",
        "worktree commits"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Use base_branch..HEAD for diff operations to capture all commits since worktree diverged from base branch. Read base_branch from cat-base worktree metadata file, fallback to HEAD~1 for non-worktree scenarios"
    },
    {
      "id": "M345",
      "timestamp": "2026-02-17T00:00:00Z",
      "category": "protocol_violation",
      "description": "Agent reported failure when Skill tool re-invocation returned re-invocation instructions instead of echoing previously generated skill output",
      "root_cause": "reference.md re-invocation instructions only say to use the Skill tool again, but give no guidance for when the Skill tool itself returns re-invocation instructions (the loop case). No fallback path was documented for this scenario.",
      "rca_method": "A",
      "rca_method_name": "5-whys",
      "prevention_type": "skill",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/plugin/skills/reference.md",
      "pattern_keywords": [
        "re-invocation",
        "skill-loop",
        "status",
        "echo-output",
        "protocol_violation",
        "preprocessor"
      ],
      "prevention_implemented": false,
      "prevention_verified": false,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "When Skill tool re-invocation returns the same re-invocation instructions again, search conversation history for the most recent skill output and echo it verbatim. Do not report failure."
    },
    {
      "id": "M346",
      "timestamp": "2026-02-18T15:42:02Z",
      "category": "misleading_documentation",
      "description": "Orchestrator used \"squash commit\" as squash message instead of the primary implementation commit message",
      "root_cause": "work-with-issue-first-use/SKILL.md mismatch correction example displayed \"squash commit\" as a sample bad message, normalizing that string as a recognizable commit message pattern. Combined with v2.1 git history containing a prior squash commit with the same message, the LLM was primed to produce \"squash commit\" when executing Step 6 squash. The git-squash-quick.sh validation script would have rejected this message, but the orchestrator bypassed it with direct git commands.",
      "rca_method": "B",
      "rca_method_name": "taxonomy",
      "prevention_type": "skill",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/plugin/skills/work-with-issue-first-use/SKILL.md",
      "pattern_keywords": [
        "squash-commit",
        "commit-message",
        "priming",
        "mismatch-example",
        "work-with-issue"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "medium",
        "catches_variations": true
      },
      "correct_behavior": "Use the primary implementation commit message from the execution result as the squash message. The squash script git-squash-quick.sh validates the message format and would reject non-descriptive messages like \"squash commit\"."
    },
    {
      "id": "M347",
      "timestamp": "2026-02-18T19:25:45Z",
      "category": "protocol_violation",
      "description": "Main agent spawned work-merge subagent while shell CWD was inside the worktree, causing shell session corruption after worktree removal",
      "root_cause": "Documentation in work-with-issue-first-use/SKILL.md (line 719) instructs agent to cd /workspace before spawning the merge subagent, but agent failed to comply. The instruction existed but the protocol was violated. Subagent operates in its own shell context so checking subagent CWD does not help - the MAIN agent must exit the worktree before delegation.",
      "rca_method": "C",
      "rca_method_name": "causal-barrier",
      "prevention_type": "hook",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/client/src/main/java/io/github/cowwoc/cat/hooks/task/EnforceWorktreeSafetyBeforeMerge.java",
      "pattern_keywords": [
        "worktree-removal",
        "cwd-corruption",
        "shell-session",
        "work-merge",
        "cd-before-spawn"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Before spawning the work-merge subagent, run 'cd /workspace' so the main agent's shell CWD is not inside the worktree when the subagent removes it."
    },
    {
      "id": "M348",
      "timestamp": "2026-02-18T19:30:42Z",
      "category": "protocol_violation",
      "description": "merge-and-cleanup.sh did not delete backup-before-squash-* branches left by git-squash-quick.sh after successful merge",
      "root_cause": "work-with-issue Step 6 runs git-squash-quick.sh before each approval gate presentation. When the workflow loops (user rejects, more work done, loop back to Step 6), each squash iteration creates a new uniquely-timestamped backup branch. git-squash-quick.sh only deletes the backup it JUST created on success — it cannot know about backups from previous loop iterations. merge-and-cleanup.sh, which runs after the final successful merge, had no logic to delete these orphaned backup branches.",
      "rca_method": "A",
      "rca_method_name": "5-whys",
      "prevention_type": "code_fix",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/plugin/scripts/merge-and-cleanup.sh",
      "pattern_keywords": [
        "backup-branch",
        "squash-cleanup",
        "merge-and-cleanup",
        "git-squash-quick",
        "orphaned-branches",
        "approval-gate-retry"
      ],
      "prevention_implemented": false,
      "prevention_verified": false,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "merge-and-cleanup.sh should delete all backup-before-squash-* branches after a successful merge. Add a step between branch deletion and lock release that runs: git branch | grep 'backup-before-squash-' | while read b; do git branch -D $b; done"
    },
    {
      "id": "M349",
      "timestamp": "2026-02-18T22:17:37Z",
      "category": "incorrect_implementation",
      "description": "Status display inner boxes rendered with individually-sized widths, causing inner right borders to appear at different horizontal positions (jagged right edges)",
      "root_cause": "generateStatusDisplay() calls buildInnerBox() for each major version without coordinating widths. Each call independently calculates boxWidth from its own content, so boxes with more content are wider. Different-width inner boxes placed in the outer box create visually jagged right borders even though the OUTER box right border aligns correctly.",
      "rca_method": "B",
      "rca_method_name": "taxonomy",
      "prevention_type": "code_fix",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/client/src/main/java/io/github/cowwoc/cat/hooks/skills/GetStatusOutput.java",
      "pattern_keywords": [
        "box-alignment",
        "inner-box-width",
        "status-display",
        "buildInnerBox",
        "uniform-width"
      ],
      "prevention_implemented": false,
      "prevention_verified": false,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Pre-calculate the maximum inner box content width across all major versions, then pass that as forcedWidth to each buildInnerBox() call so all inner boxes render at uniform width."
    },
    {
      "id": "M350",
      "timestamp": "2026-02-18T22:45:00Z",
      "category": "protocol_violation",
      "description": "Implemented empty-string fallback for invalid sessionId format instead of throwing exception",
      "root_cause": "The fail-fast principle in common.md only showed Bash examples and did not list identifiers used to construct file paths as non-acceptable fallbacks; the HookInput.getString() pattern of returning empty string primed the agent to use the same pattern for getSessionId()",
      "rca_method": "C",
      "rca_method_name": "causal-barrier",
      "prevention_type": "documentation",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/.claude/rules/common.md",
      "pattern_keywords": [
        "fail-fast",
        "fallback",
        "empty-string",
        "session-id",
        "file-path",
        "java"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Throw IllegalArgumentException when sessionId format is invalid, since sessionId is used to construct file paths"
    },
    {
      "id": "M351",
      "timestamp": "2026-02-18T18:38:00Z",
      "category": "protocol_violation",
      "description": "Main agent presented approval gate before verifying STATE.md was closed; implementation subagent committed code but STATE.md remained in-progress",
      "root_cause": "work-with-issue-first-use/SKILL.md Step 7 (Approval Gate) has no verification that STATE.md is closed before presenting the gate. The skill instructs the subagent to close STATE.md (Step 3 delegation prompt) but never verifies compliance prior to the approval gate.",
      "rca_method": "A",
      "rca_method_name": "5-whys",
      "prevention_type": "skill",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/plugin/skills/work-with-issue-first-use/SKILL.md",
      "pattern_keywords": [
        "state-md",
        "approval-gate",
        "closed-status",
        "subagent-compliance",
        "work-with-issue",
        "protocol-violation"
      ],
      "prevention_implemented": false,
      "prevention_verified": false,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Before presenting the approval gate in Step 7, verify STATE.md status is 'closed'. If not closed, update STATE.md and amend the last commit to include the closure before proceeding."
    },
    {
      "id": "M352",
      "timestamp": "2026-02-18T00:00:00Z",
      "category": "protocol_violation",
      "description": "Convention file change placed in feature commit instead of refactor commit when establishing and applying a new Java convention",
      "root_cause": "CLAUDE.md commit type rules did not address the case where a convention file change and its application across files are the same logical unit. The agent split by file location (java.md -> config-like) rather than by topic (establish+apply convention = refactor unit).",
      "rca_method": "B",
      "rca_method_name": "taxonomy",
      "prevention_type": "documentation",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/CLAUDE.md",
      "pattern_keywords": [
        "commit-grouping",
        "convention-file",
        "java-md",
        "refactor-commit",
        "mixed-commit"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "When adding a new convention to java.md AND applying it across files in the same session, include the java.md change in the SAME commit as the refactoring work. Group commits by topic (establish + apply = one unit), not by file location."
    },
    {
      "id": "M353",
      "timestamp": "2026-02-18T00:00:00Z",
      "category": "protocol_violation",
      "description": "Agent output status skill meta-instructions to user instead of only copying the <output> tag content verbatim",
      "root_cause": "status-first-use/SKILL.md uses negative instructional framing ('Do NOT summarize...') which per M408 triggers LLM analytical/processing mode instead of mechanical verbatim copy mode. The NEXT STEPS table is embedded in the instruction block, causing the agent to reproduce it as instruction text AND again as user-facing output (duplication). User-centric framing ('The user wants you to respond with this text verbatim:') is required to trigger correct mechanical execution.",
      "rca_method": "C",
      "rca_method_name": "causal-barrier",
      "prevention_type": "skill",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/plugin/skills/status-first-use/SKILL.md",
      "pattern_keywords": [
        "verbatim-output",
        "negative-framing",
        "meta-instructions-leaked",
        "status-skill",
        "user-centric-framing",
        "M408-pattern"
      ],
      "prevention_implemented": false,
      "prevention_verified": false,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Replace negative instructional framing with user-centric framing: 'The user wants you to respond with the following text verbatim:' followed by the <output> tag. Move NEXT STEPS out of the instruction block and into a separate 'append after verbatim content' instruction to prevent duplication."
    },
    {
      "id": "M354",
      "timestamp": "2026-02-19T00:00:00Z",
      "category": "protocol_violation",
      "description": "Agent skipped verbatim echo of status box content and only output the NEXT STEPS table when invoking /cat:status",
      "root_cause": "status-first-use/SKILL.md instruction ordering places NEXT STEPS table between the instruction and the <output> tag, causing the agent to treat NEXT STEPS as the target output and the <output> tag content as preprocessing data already consumed. The agent read the instruction ('The user wants you to respond with the contents verbatim') but identified NEXT STEPS (the most visible content after the instruction) as what to produce, skipping the actual box. Structural fix required: move NEXT STEPS after the <output> tag so content order mirrors output order.",
      "rca_method": "A",
      "rca_method_name": "5-whys",
      "prevention_type": "skill",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/plugin/skills/status-first-use/SKILL.md",
      "pattern_keywords": [
        "verbatim-output",
        "status-skill",
        "skipped-box-content",
        "instruction-ordering",
        "output-tag-position",
        "NEXT-STEPS-only"
      ],
      "prevention_implemented": false,
      "prevention_verified": false,
      "recurrence_of": "M353",
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Restructure status-first-use/SKILL.md so the <output skill='status'> tag appears BEFORE the NEXT STEPS table, mirroring the output order. Agent reads instruction -> sees <output> tag -> echoes box -> appends NEXT STEPS. Content position should match production order.",
      "task_creation_info": {
        "suggested_title": "Fix status-first-use instruction ordering to prevent box content skip",
        "suggested_description": "Move NEXT STEPS table in status-first-use/SKILL.md to appear AFTER the <output skill='status'> tag so the document content order mirrors the required output order. Current ordering (instruction -> NEXT STEPS table -> <output> tag) causes the agent to identify NEXT STEPS as the output target and skip echoing the box content. New ordering: instruction -> <output> tag -> NEXT STEPS table.",
        "suggested_acceptance_criteria": [
          "status-first-use/SKILL.md: <output skill='status'> tag appears before NEXT STEPS table",
          "Agent echoes full status box content verbatim before NEXT STEPS table",
          "Empirical test on haiku with production-size content achieves >= 90% compliance"
        ]
      }
    },
    {
      "id": "M355",
      "timestamp": "2026-02-19T11:24:00Z",
      "category": "protocol_violation",
      "description": "Agent corrupted verbatim status box output by inserting horizontal rule characters (────────────────) between sections that were not in the original output",
      "root_cause": "REFLECTION failure: Agent read the verbatim instruction but its helpful-synthesis training overrode it by adding structural separators it perceived as clarifying. The instruction 'copy the contents verbatim' does not explicitly forbid adding characters, leaving room for the agent to 'enhance' the output while believing it complied. Third recurrence of verbatim output failure for status skill (M353, M354, M355).",
      "rca_method": "B",
      "rca_method_name": "taxonomy",
      "prevention_type": "skill",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/plugin/skills/status-first-use/SKILL.md",
      "pattern_keywords": [
        "verbatim-output",
        "status-skill",
        "output-corruption",
        "box-drawing-insertion",
        "horizontal-rule-added",
        "PATTERN-008"
      ],
      "prevention_implemented": false,
      "prevention_verified": false,
      "recurrence_of": "M353",
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Copy-paste the exact text from the <output skill='status'> tag character-for-character with zero additions or modifications. Do not insert line separators, horizontal rules, headers, or any characters not already present in the tag.",
      "task_creation_info": {
        "suggested_title": "Strengthen status-first-use verbatim instruction to prevent output corruption",
        "suggested_description": "Third recurrence (M353, M354, M355) of verbatim output failure for the status skill. Agent adds horizontal rule characters or other structural elements to the output despite 'verbatim' instruction. The current framing 'The user wants you to respond with the contents verbatim' leaves room for the agent to add characters while believing it complied. Strengthen the instruction in status-first-use/SKILL.md to explicitly prohibit additions: 'Copy-paste the exact text character-for-character with zero additions or modifications. Do not insert line separators, horizontal rules, headers, or any characters not already present in the tag.' Also consider escalating to a PostToolUse validation hook (PATTERN-008) since skill-level prevention has failed twice.",
        "suggested_acceptance_criteria": [
          "status-first-use/SKILL.md instruction explicitly states zero additions/modifications allowed",
          "Instruction prohibits inserting line separators, horizontal rules, or headers not in original",
          "Empirical test with haiku model shows no extra characters inserted in 5 consecutive runs",
          "Consider adding PostToolUse hook to detect box-drawing characters in assistant output not preceded by script execution"
        ]
      }
    },
    {
      "id": "M356",
      "timestamp": "2026-02-19T11:38:00Z",
      "category": "tool_misuse",
      "description": "Pattern 11 in AutoLearnMistakes.java fires false positives on tool output containing CRITICAL from stakeholder review results and grep output",
      "root_cause": "Pattern 11 checks tool output (gitFiltered) for CRITICAL+ISSUE/ERROR/etc but the stakeholder review box legitimately outputs Result lines containing Critical issue text, and grep searches return source code lines with CRITICAL. The pattern should only apply to assistant self-acknowledgment messages, not tool output.",
      "rca_method": "C",
      "rca_method_name": "causal-barrier",
      "prevention_type": "code_fix",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/client/src/main/java/io/github/cowwoc/cat/hooks/tool/post/AutoLearnMistakes.java",
      "pattern_keywords": [
        "false_positive",
        "hook_detection",
        "critical_self_acknowledgment",
        "stakeholder_review"
      ],
      "prevention_implemented": false,
      "prevention_verified": false,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Pattern 11 (critical self-acknowledgment) should only scan assistant messages (assistantMsg), not tool output. The existing check at lines 286-288 already handles legitimate critical self-acknowledgments in assistant messages. Remove Pattern 11 from the tool output scanning block entirely."
    },
    {
      "id": "M357",
      "timestamp": "2026-02-19T16:30:00Z",
      "category": "missing_documentation",
      "description": "Skill(cat:stakeholder-selection-box) invoked via Skill tool with args, but ${ARGUMENTS} was empty because SkillLoader did not resolve ARGUMENTS variable and the skill bypassed the SkillLoader pipeline entirely",
      "root_cause": "stakeholder-selection-box/SKILL.md called the CLI handler directly via !backtick instead of routing through load-skill.sh/SkillLoader. SkillLoader did not resolve ${ARGUMENTS} as a built-in variable, so even if the skill had used load-skill.sh, the args from the Skill tool invocation would not have been substituted.",
      "rca_method": "C",
      "rca_method_name": "causal-barrier",
      "prevention_type": "code_fix",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/client/src/main/java/io/github/cowwoc/cat/hooks/util/SkillLoader.java",
      "pattern_keywords": [
        "skill-arguments",
        "ARGUMENTS-variable",
        "SkillLoader",
        "stakeholder-selection-box",
        "load-skill",
        "variable-substitution"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Skills needing ${ARGUMENTS} substitution must route through load-skill.sh/SkillLoader (which now resolves ${ARGUMENTS}). SkillLoader.load() accepts args as a second parameter and substitutes ${ARGUMENTS} in all skill content."
    },
    {
      "id": "M357",
      "timestamp": "2026-02-19T11:37:00Z",
      "category": "tool_misuse",
      "description": "verify-audit CLI failed with Jackson Unrecognized character escape \\! when evidence strings contained backtick-exclamation preprocessing directives serialized via shell heredoc",
      "root_cause": "Shell string interpolation in RESULTS_JSON heredoc embedded backtick-exclamation sequences literally in JSON string values, producing invalid JSON escape sequence that Jackson rejected. The verify-implementation skill showed heredoc as example but did not specify that evidence strings with special characters require json.dumps() serialization.",
      "rca_method": "C",
      "rca_method_name": "causal-barrier",
      "prevention_type": "skill",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/plugin/skills/verify-implementation-first-use/SKILL.md",
      "pattern_keywords": [
        "json-serialization",
        "shell-heredoc",
        "backtick-exclamation",
        "jackson",
        "verify-audit"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": "M330",
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Use Python subprocess with json.dumps() to pass results JSON to verify-audit CLI tool, ensuring all evidence string content is safely escaped regardless of special characters"
    }
  ]
}
